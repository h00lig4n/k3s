ingress:
  enabled: true
  className: traefik
  tls:
    enabled: true
    secret: tls-certificate

pod:
  kind: Deployment
  env:
    - name: TZ
      value: Europe/Stockholm
  extraVolumeMounts:
    - name: extra
      mountPath: /config/users.yaml
      subPath: users.yaml
    - name: extra
      mountPath: /secrets/oidc.pem
      subPath: oidc.pem
  extraVolumes:
    - name: extra
      secret: { secretName: authelia }

secret:
  existingSecret: authelia

configMap:
  access_control:
    default_policy: deny
    rules:
      - domain: "*.mydomain.com"
        policy: one_factor
  
  log:
    level: info

  session:
    cookies:
      - name: authelia_session
        domain: mydomain.com
        authelia_url: https://auth.mydomain.com
        default_redirection_url: https://auth.mydomain.com

  storage:
    local: { enabled: true }

  notifier:
    filesystem: { enabled: true }

  authentication_backend:
    file: { enabled: true, path: /config/users.yaml }

  identity_providers:
    oidc:
      enabled: true
      jwks:
        - key_id: default
          algorithm: RS256
          use: sig
          key: { path: /secrets/oidc.pem }
      claims_policies:
        grafana:
          id_token: ['email', 'name', 'groups', 'preferred_username']

      clients:
        - client_id: 'grafana'
          #claims_policy: 'grafana'
          client_name: 'Grafana'
          client_secret: 'This is not the real value'
          public: false
          authorization_policy: 'one_factor'
          require_pkce: true
          pkce_challenge_method: 'S256'
          redirect_uris:
            - 'https://grafana.example.com/login/generic_oauth'
          scopes:
            - 'openid'
            - 'profile'
            - 'groups'
            - 'email'
          response_types:
            - 'code'
          grant_types:
            - 'authorization_code'
          access_token_signed_response_alg: 'none'
          userinfo_signed_response_alg: 'none'
          token_endpoint_auth_method: 'client_secret_basic'